# 07. ì—°ì‚°ì ì˜¤ë²„ë¡œë”©ê³¼ ê¸°íƒ€ ê´€ë¡€

- ì–´ë–¤ í´ë˜ìŠ¤ ì•ˆì— plusë¼ëŠ” ì´ë¦„ì˜ íŠ¹ë³„í•œ ë©”ì†Œë“œë¥¼ ì •ì˜í•˜ì—¬ ê·¸ í´ë˜ìŠ¤ ì¸ìŠ¤í„´ìŠ¤ì— ëŒ€í•´ + ì—°ì‚°ìë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.
    - ì´ëŸ° ì‹ìœ¼ë¡œ ì–´ë–¤ ì–¸ì–´ ê¸°ëŠ¥ê³¼ ë¯¸ë¦¬ ì •í•´ì§„ ì´ë¦„ì˜ í•¨ìˆ˜ë¥¼ ì—°ê²°í•´ì£¼ëŠ” ê¸°ì—…ì„ `ê´€ë¡€(Conventrion)` ë¼ê³  í•œë‹¤.
- ì½”í‹€ë¦°ì—ì„œ ê´€ê³„ë¥¼ ì±„íƒí•œ ì´ìœ ?
    - ê¸°ì¡´ ìë°” í´ë˜ìŠ¤ë¥¼ ì½”í‹€ë¦° ì–¸ì–´ì— ì ìš©í•˜ê¸° ìœ„í•¨
    - í™•ì¥ í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ë©´ ê¸°ì¡´ í´ë˜ìŠ¤ì— ìƒˆë¡œìš´ ë©”ì†Œë“œë¥¼ ì¶”ê°€í•  ìˆ˜ ìˆë‹¤. ë”°ë¼ì„œ ê¸°ì¡´ ìë°” í´ë˜ìŠ¤ì— ëŒ€í•´ í™•ì¥ í•¨ìˆ˜ë¥¼ êµ¬í˜„í•˜ë©´ì„œ ê´€ë¡€ì— ë”°ë¼ ì´ë¦„ì„ ë¶™ì´ë©´ ê¸°ì¡´ ìë°” ì½”ë“œë¥¼ ë°”ê¾¸ì§€ ì•Šì•„ë„ ìƒˆë¡œìš´ ê¸°ëŠ¥ì„ ì‰½ê²Œ ë¶€ì—¬í•  ìˆ˜ ìˆë‹¤.

## ğŸ“Â ì‚°ìˆ  ì—°ì‚°ì ì˜¤ë²„ë¡œë”©

- `operator` í‚¤ì›Œë“œë¥¼ ë¶™ì—¬ì„œ ì‚¬ìš©í•´ì•¼í•œë‹¤. ì–´ë–¤ í•¨ìˆ˜ê°€ ê´€ë¡€ë¥¼ ë”°ë¥´ëŠ” í•¨ìˆ˜ì„ì„ ëª…í™•íˆ í•  ìˆ˜ ìˆë‹¤.
    - operatorê°€ ì—†ëŠ”ë° ê´€ë¡€ì— ì‚¬ìš©í•˜ëŠ” í•¨ìˆ˜ ì´ë¦„ì„ ì“°ë©´ ì˜¤ë¥˜ë¥¼ í†µí•´ ì´ë¦„ì´ ê²¹ì³¤ë‹¤ëŠ” ì‚¬ì‹¤ì„ ì•Œë ¤ì¤€ë‹¤.

### ì´í•­ ì‚°ìˆ  ì—°ì‚° ì˜¤ë²„ë¡œë”©

- ë‘ ì ì„ ë”í•˜ëŠ” ì—°ì‚°

```kotlin
data class Point(val x: Int, val y: Int) {
    operator fun plus(other: Point): Point {
        return Point(x + other.x, y + other.y)
    }
}
>>> val p1 = Point(10, 20)
>>> val p2 = Point(30, 40)
>>> println(p1 + p2)
>>> Point(x=40, y=60)
```

| ì‹ | í•¨ìˆ˜ ì´ë¦„ |
| --- | --- |
| a * b | times |
| a / b | div |
| a % b | mod |
| a + b | plus |
| a - b | minus |
- ì—°ì‚°ì ìš°ì„ ìˆœìœ„ëŠ” ì–¸ì œë‚˜ í‘œì¤€ ìˆ«ì íƒ€ì…ì— ëŒ€í•œ ì—°ì‚°ì ìš°ì„ ìˆœìœ„ì™€ ê°™ìŒ

### ë³µí•© ëŒ€ì… ì—°ì‚°ì ì˜¤ë²„ë¡œë”©

- ì´í•­ì—°ì‚°ì (plus) ì™€ ê°™ì€ ì—°ì‚°ìë¥¼ ì˜¤ë²„ë¡œë”©í•˜ë©´ ì½”í‹€ë¦°ì€ ê·¸ì™€ ê´€ë ¨ìˆëŠ” (+=, -=) ë“±ì˜ ë³µí•© ëŒ€ì… ì—°ì‚°ìë„ í•¨ê»˜ ì§€ì›í•œë‹¤.

```kotlin
var point = Point(1, 2)
point += Point(3, 4)
```

- += ì—°ì‚°ì´ ê°ì²´ì— ëŒ€í•œ ì°¸ì¡°ë¥¼ ë‹¤ë¥¸ ì°¸ì¡°ë¡œ ë°”ê¾¸ê¸°ë³´ë‹¨ ì›ë˜ ê°ì²´ì˜ ë‚´ë¶€ ìƒíƒœë¥¼ ë³€ê²½í•˜ê²Œ ë§Œë“¤ê³  ì‹¶ì€ê²½ìš°
    - ë°˜í™˜ íƒ€ì…ì´ Unitì¸ `plusAssign` ì„ ì •ì˜í•˜ë©´ ì½”í‹€ë¦°ì€ += ì—°ì‚°ìì— ê·¸ í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•œë‹¤.

```kotlin
operator fun <T> MutableCollection<T>.plusAssign(element: T) {
    this.add(element)
}

val numbers = ArrayList<Int>()
numbers += 42
println(numbers[0])
>>> 42
```

### ë‹¨í•­ ì—°ì‚°ì ì˜¤ë²„ë¡œë”©

- ë‹¨í•­ ì—°ì‚°ìë¥¼ ì˜¤ë²„ë¡œë”©í•˜ëŠ” ì ˆì°¨ë„ ì´í•­ ì—°ì‚°ìì™€ ë™ì¼í•˜ë‹¤.

```kotlin
data class Point(val x: Int, val y: Int)

operator fun Point.unaryMinus(): Point {
    return Point(-x, -y)
}

val p = Point(10, 20)
println(-p)
>>> Point(x=-10, y=-20)
```

| ì‹ | í•¨ìˆ˜ ì´ë¦„ |
| --- | --- |
| +a | unaryPlus |
| -a | unaryMinus |
| !a | not |
| ++a, a++ | inc |
| â€”a, aâ€” | dec |

## ğŸ“Â ë¹„êµ ì—°ì‚°ì ì˜¤ë²„ë¡œë”©

### ë™ë“±ì„± ì—°ì‚°ì: equals

- ì½”í‹€ë¦°ì€ `==` , `!=` ì—°ì‚°ìë¥¼ ì‚¬ìš©í•˜ëŠ” ì‹ì€ `equals` ë©”ì„œë“œ í˜¸ì¶œë¡œ ì»´íŒŒì¼ ëœë‹¤.
- `equals` ëŠ” Anyì— ì •ì˜ëœ ë©”ì†Œë“œì´ë¯€ë¡œ overrideê°€ í•„ìš”í•˜ë‹¤. Anyì˜ equalsì—ëŠ” operator í‚¤ì›Œë“œê°€ ë¶™ì–´ìˆì–´ ì˜¤ë²„ë¼ì´ë“œë¥¼ í•˜ëŠ”ê²½ìš° ë¶™ì´ì§€ ì•Šì•„ë„ ìë™ìœ¼ë¡œ ìƒìœ„í´ë˜ìŠ¤ì˜ operator ì§€ì •ì´ ì ìš©ëœë‹¤.

<aside>
ğŸ’¡ ì‹ë³„ì ë¹„êµ ì—°ì‚°ì (===)ì€ ìì‹ ê³¼ ìˆ˜ì‹ ê°ì²´ê°€ ì„œë¡œ ê°™ì€ ê°ì²´ ê°€ë¥´í‚¤ëŠ”ì§€ ë¹„êµí•œë‹¤. ìë°”ì—ì„œì˜ ==ê³¼ ê°™ë‹¤.

</aside>

### ìˆœì„œ ì—°ì‚°ì: compareTo

- ìë°”ì—ì„œëŠ” Comparable ì¸í„°í˜ì´ìŠ¬í˜ êµ¬í˜„í•˜ì—¬ ê°ì²´ì™€ì˜ ë¹„êµë¥¼ í•˜ëŠ” ì½”ë“œë¥¼ ì‘ì„±í•´ì•¼í•œë‹¤.
- ì½”í‹€ë¦°ì˜ ê²½ìš° Comparable ì¸í„°í˜ì´ìŠ¤ ì•ˆì—ìˆëŠ” `compareTo` ê´€ë¡€ë¥¼ ì œê³µí•˜ì—¬ ë¹„êµ ì—°ì‚°ì(<, >, â‰¤, â‰¥) ëŠ” compareTo í˜¸ì¶œë¡œ ì»´íŒŒì¼ ë˜ê³  ë°˜í™˜ê°’ì€ Intë‹¤.

```kotlin
class Person(
        val firstName: String, val lastName: String
) : Comparable<Person> {

    override fun compareTo(other: Person): Int {
        return compareValuesBy(this, other,
            Person::lastName, Person::firstName)
    }
}

val p1 = Person("Alice", "Smith")
val p2 = Person("Bob", "Johnson")
println(p1 < p2)
>>> false
```

## ğŸ“Â ì»¬ë ‰ì…˜ê³¼ ë²”ìœ„ì— ëŒ€í•´ ì“¸ ìˆ˜ ìˆëŠ” ê´€ë¡€

### ì¸ë±ìŠ¤ë¡œ ì›ì†Œì— ì ‘ê·¼: getê³¼ set

- ì½”í‹€ë¦°ì—ì„œëŠ” ë§µì˜ ì›ì†Œì— ì ‘ê·¼í•  ë•Œ ê°ê´„í˜¸(`[]`) ë¥¼ ì‚¬ìš©í•œë‹¤.

```kotlin
val value = map[key] // map.get(key)
mutableMap[key] = newValue // mutableMap.put(key, newValue)
```

- get, set ê´€ë¡€ êµ¬í˜„

```kotlin
data class Point(val x: Int, val y: Int)
data class MutablePoint(var x: Int, var y: Int)

operator fun Point.get(index: Int): Int {
    return when(index) {
        0 -> x
        1 -> y
        else -> throw IndexOutOfBoundsException("Invalid coordinate $index")
    }
}

operator fun MutablePoint.set(index: Int, value: Int) {
    when(index) {
        0 -> x = value
        1 -> y = value
        else ->
            throw IndexOutOfBoundsException("Invalid coordinate $index")
    }
}

val p = Point(10, 20)
println(p[1])
val p1 = MutablePoint(10, 20)
p1[1] = 42
println(p1)
>>> 20
>>> MutablePoint(x=10, y=42)
```

### in ê´€ë¡€

- `in` ì€ ê°ì²´ê°€ ì»¬ë ‰ì…˜ì— ë“¤ì–´ìˆëŠ”ì§€ ê²€ì‚¬í•œë‹¤. in ì—°ì‚°ìì™€ ëŒ€ì‘í•˜ëŠ” í•¨ìˆ˜ëŠ” containsì´ë‹¤.

```kotlin
data class Rectangle(val upperLeft: Point, val lowerRight: Point)

operator fun Rectangle.contains(p: Point): Boolean {
    return p.x in upperLeft.x until lowerRight.x && 
        p.y in upperLeft.y until lowerRight.y 
}

val rect = Rectangle(Point(10, 20), Point(50, 50))
println(Point(20, 30) in rect)
>>> true
println(Point(5, 5) in rect)
>>> false
```

### rangeTo ê´€ë¡€

- ë²”ìœ„ëŠ” ë§Œë“¤ë ¤ë©´ `..` êµ¬ë¶„ì„ ì‚¬ìš©í•´ì•¼ í•œë‹¤. í•´ë‹¹ ì—°ì‚°ìëŠ” rangeTo í•¨ìˆ˜ë¡œ ì»´íŒŒì¼ ëœë‹¤.
- ì½”í‹€ë¦° í‘œì¤€ ë¼ì´ë¸ŒëŸ¬ë¦¬ì—ëŠ” ëª¨ë“  Comparable ê°ì²´ì— ëŒ€í•´ ì ìš© ê°€ëŠ¥í•œ rangeTo í•¨ìˆ˜ê°€ ë“¤ì–´ìˆë‹¤.
- rangeTo ì—°ì‚°ìëŠ” ë‹¤ë¥¸ ì‚°ìˆ  ì—°ì‚°ìë³´ë‹¤ ìš°ì„ ìˆœìœ„ê°€ ë‚®ë‹¤. í•˜ì§€ë§Œ í˜¼ë™ì„ í”¼í•˜ê¸° ìœ„í•´ ê´„í˜¸ë¡œ ì¸ìë¥¼ ê°ì‹¸ì£¼ë©´ ì¢‹ë‹¤.

```kotlin
operator fun <T: Comparable<T>> T.rangeTo(that: T): ClosedRange<T>

(0..n).forEach { print(it) }
```

### for ë£¨í”„ë¥¼ ìœ„í•œ iterator ê´€ë¡€

- ì½”í‹€ë¦°ì—ì„œ for ë£¨í”„ëŠ” ë²”ìœ„ ê²€ì‚¬ì™€ ê°™ì´ in ì—°ì‚°ìë¥¼ ì‚¬ìš©í•œë‹¤.
- ì´ ë˜í•œ ê´€ë¡€ì´ë¯€ë¡œ iterator ë©”ì†Œë“œë¥¼ í™•ì¥ í•¨ìˆ˜ë¡œ ì •ì˜ í•  ìˆ˜ ìˆë‹¤.

```kotlin
operator fun ClosedRange<LocalDate>.iterator(): Iterator<LocalDate> =
    object : Iterator<LocalDate> {
        var current = start

        override fun hasNext() =
            current <= endInclusive

        override fun next() = current.apply {
            current = plusDays(1)
        }
  }

val newYear = LocalDate.ofYearDay(2017, 1)
val daysOff = newYear.minusDays(1)..newYear
for (dayOff in daysOff) { println(dayOff) }
>>> 2016-12-31
>>> 2017-01-01 
```

## ğŸ“Â êµ¬ì¡° ë¶„í•´ ì„ ì–¸ê³¼ component í•¨ìˆ˜

- êµ¬ì¡° ë¶„í•´ë¥¼ ì‚¬ìš©í•˜ë©´ ë³µí•©ì ì¸ ê°’ì„ ë¶„í•´í•´ì„œ ì—¬ëŸ¬ ë‹¤ë¥¸ ë³€ìˆ˜ë¥¼ í•œêº¼ë²ˆì— ì´ˆê¸°í™” í•  ìˆ˜ ìˆë‹¤.
- êµ¬ì¡° ë¶„í•´ ì„ ì–¸ì€ ë‚´ë¶€ì ìœ¼ë¡œ componentNì´ë¼ëŠ” í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•œë‹¤. (ê´€ë¡€ ì‚¬ìš©)
- data classì—ì„œëŠ” ì»´íŒŒì¼ëŸ¬ê°€ ìë™ìœ¼ë¡œ componentN í•¨ìˆ˜ë¥¼ ë§Œë“¤ì–´ ì¤€ë‹¤.

```kotlin
class Point(val x: Int, val y: Int) {
    operator fun component1() = x
    operator fun component2() = y
}

val p = Point(10, 20)
val (x, y) = p
```

<aside>
ğŸ’¡ componentNì€ 1 ~ 5ê¹Œì§€ë§Œ ì‚¬ìš©ì´ ê°€ëŠ¥í•˜ë‹¤.
ì»¬ë ‰ì…˜ í¬ê¸°ë¥¼ ë²—ì–´ë‚˜ëŠ” ìœ„ì¹˜ì˜ ì›ì†Œì— ëŒ€í•œ êµ¬ì¡° ë¶„í•´ ì„ ì–¸ì„ ì‚¬ìš©í•˜ë©´ ì‹¤í–‰ ì‹œì ì— java.lang.ArrayIndexOutOfBoundException ì˜ˆì™¸ê°€ ë°œìƒí•œë‹¤.

</aside>

### êµ¬ì¡° ë¶„í•´ ì„ ì–¸ê³¼ ë£¨í”„

```kotlin
fun printEntries(map: Map<String, String>) {
    for ((key, value) in map) {
        println("$key -> $value")
    }
}

val map = mapOf("Oracle" to "Java", "Jetbrains" to "Kotlin")
printEntries(map)
>>> Oracle -> Java
>>> Jetbrains -> Kotlin
```

## ğŸ“Â í”„ë¡œí¼í‹° ì ‘ê·¼ì ë¡œì§ ì¬í™œìš©: ìœ„ì„ í”„ë¡œí¼í‹°

- ìœ„ì„ í”„ë¡œí¼í‹°ë¥¼ ì‚¬ìš©í•˜ë©´ ê°’ì„ ë’·ë°›ì¹¨í•˜ëŠ” í•„ë“œ (backing field)ì— ë‹¨ìˆœíˆ ì €ì¥í•˜ëŠ” ê²ƒë³´ë‹¤ ë” ë³µì¡í•œ ë°©ì‹ìœ¼ë¡œ ì‘ë™í•˜ëŠ” í”„ë¡œí¼í‹°ë¥¼ ì‰½ê²Œ êµ¬í˜„í•  ìˆ˜ ìˆë‹¤.
- ìœ„ì„ì€ ê°ì²´ê°€ ì§ì ‘ ì‘ì—…ì„ ìˆ˜í–‰í•˜ì§€ ì•Šê³  ë‹¤ë¥¸ ë„ìš°ë¯¸ ê°ì²´ê°€ ê·¸ ì‘ì—…ì„ ì²˜ë¦¬í•˜ê²Œ ë§¡ê¸°ëŠ” ë””ìì¸ íŒ¨í„´ì„ ë§í•œë‹¤. â†’ ì´ë•Œ ì‘ì—…ì„ ì²˜ë¦¬í•˜ëŠ” ê°ì²´ë¥¼ `ìœ„ì„ ê°ì²´` ë¼ê³  ë¶€ë¥¸ë‹¤.

### **ìœ„ì„ í”„ë¡œí¼í‹° ì†Œê°œ**

- p í”„ë¡œí¼í‹°ëŠ” ì ‘ê·¼ì ë¡œì§ì„ ë‹¤ë¥¸ ê°ì²´ì—ê²Œ ìœ„ì„í•œë‹¤.
- í”„ë¡œí¼í‹° ìœ„ì„ ê´€ë¡€ë¥¼ ë”°ë¥´ëŠ” Delegate í´ë˜ìŠ¤ëŠ” getValue, setValue ë©”ì†Œë“œë¥¼ ì œê³µí•´ì•¼ í•œë‹¤.

```kotlin
class Foo {
    var p: Type by Delegate()
}

class Foo {
    private val delegate = Delegate()
    var p: Type
        set(value: Type) = delegate.setValue(..., value)
    get() = delegate.getValue(...)
}
```

### ìœ„ì„ í”„ë¡œí¼í‹° ì‚¬ìš©: by lazy()ë¥¼ ì‚¬ìš©í•œ í”„ë¡œí¼í‹° ì´ˆê¸°í™” ì§€ì—°

- ì§€ì—° ì´ˆê¸°í™”ëŠ” ê°ì²´ì˜ ì¼ë¶€ë¶„ì„ ì´ˆê¸°í™”í•˜ì§€ ì•Šê³  ë‚¨ê²¨ë’€ë‹¤ê°€ ì‹¤ì œë¡œ ê·¸ ë¶€ë¶„ì˜ ê°’ì´ í•„ìš”í•œ ê²½ìš° ì´ˆê¸°í™”í•  ë•Œ ì“°ì´ëŠ” íŒ¨í„´ì´ë‹¤.
- ì´ˆê¸°í™” ê³¼ì •ì— ìì›ì„ ë§ì´ ì‚¬ìš©í•˜ê±°ë‚˜ ê°ì²´ë¥¼ ì‚¬ìš©í•  ë•Œë§ˆë‹¤ ê¼­ ì´ˆê¸°í™”í•˜ì§€ ì•Šì•„ë„ ë˜ëŠ” í”„ë¡œí¼í‹°ì— ëŒ€í•´ ì§€ì—°ì´ˆê¸°í™” íŒ¨í„´ì„ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.

```kotlin
class Email {}
fun loadEmails(person: Person): List<Email> {
    println("${person.name}ì˜ ì´ë©”ì¼ì„ ê°€ì ¸ì˜´")
    return listOf()
}

class Person(val name: String) {
    private var _emails: List<Email>? = null
    val emails: List<Email>
        get() {
            if (_emails == null) {
                _emails = loadEmails(this)
            }
            return _emails!!
        }
}
```

- ì§€ì—° ì´ˆê¸°í™”í•´ì•¼ í•˜ëŠ” í”„ë¡œí¼í‹°ê°€ ë§ì•„ì§€ë©´ ì½”ë“œê°€ ë§ì•„ì§€ê³ , í•´ë‹¹ ì½”ë“œëŠ” ìŠ¤ë ˆë“œ ì•ˆì „í•˜ì§€ ì•Šì•„ì„œ ì–¸ì œë‚˜ ì œëŒ€ë¡œ ì‘ë™í•œë‹¤ê³  ë§í•  ìˆ˜ë„ ì—†ë‹¤.

```kotlin
class Person(val name: String) {
    val emails by lazy { loadEmails(this) }
}
```

- ì½”í‹€ë¦°ì—ì„œ `lazy` í•¨ìˆ˜ëŠ” ê´€ë¡€ì— ë§ëŠ” ì‹œë“œë‹ˆì²˜ì˜ getValue ë©”ì†Œë“œê°€ ë“¤ì–´ìˆëŠ” ê°ì²´ë¥¼ ë°˜í™˜í•œë‹¤. ë”°ë¼ì„œ lazyë¥¼ by í‚¤ì›Œë“œì™€ í•¨ê»˜ ì‚¬ìš©í•´ ìœ„ì„ í”„ë¡œí¼í‹°ë¥¼ ë§Œë“¤ ìˆ˜ ìˆë‹¤.

### ìœ„ì„ í”„ë¡œí¼í‹° êµ¬í˜„

```kotlin
import java.beans.PropertyChangeListener
import java.beans.PropertyChangeSupport

open class PropertyChangeAware {
    protected val changeSupport = PropertyChangeSupport(this)

    fun addPropertyChangeListener(listener: PropertyChangeListener) {
        changeSupport.addPropertyChangeListener(listener)
    }

    fun removePropertyChangeListener(listener: PropertyChangeListener) {
        changeSupport.removePropertyChangeListener(listener)
    }
}

class Person(
    val name: String, age: Int, salary: Int
) : PropertyChangeAware() {

    var age: Int = age
        set(newValue) {
            val oldValue = field
            field = newValue
            changeSupport.firePropertyChange(
                "age", oldValue, newValue
            )
        }

    var salary: Int = salary
        set(newValue) {
            val oldValue = field
            field = newValue
            changeSupport.firePropertyChange(
                "salary", oldValue, newValue
            )
        }
}

val p = Person("ppeper", 34, 2000)
p.addPropertyChangeListener { event ->
    println(
        "Property ${event.propertyName} changed " +
                "from ${event.oldValue} to ${event.newValue}"
    )
}

============ìœ„ì„ í”„ë¡œí¼í‹°=============

class Person(
    val name: String, age: Int, salary: Int
) : PropertyChangeAware() {
    var age: Int by ObservableProperty(age, changeSupport)
    var salary: Int by ObservableProperty(salary, changeSupport)
}

class ObservableProperty (
    var propValue: Int, val changeSupport: PropertyChangeSupport
) {
    operator fun getValue(p: Person, prop: KProperty<*>): Int = propValue
    operator fun setValue(p: Person, prop: KProperty<*>, newValue: Int) {
        val oldValue = propValue
        propValue  = newValue
        changeSupport.firePropertyChange(prop.name, oldValue, newValue)
    }
}

============Delegates obervable=============
class Person(
    val name: String, age: Int, salary: Int
) : PropertyChangeAware() {
    private val observer = {
        prop: KProperty<*>, oldValue: Int, newValue: Int -> 
        changeSupport.firePropertyChange(prop.name, oldValue, newValue)
    }
    var age: Int by Delegates.observable(age, observer)
    var salary: Int by Delegates.observable(salary, observer)
}

p.age = 35
p.salary = 2100
>>> Property age changed from 34 to 35
>>> Property salary changed from 2000 to 2100
```

### **ìœ„ì„ í”„ë¡œí¼í‹° ì»´íŒŒì¼ ê·œì¹™**

```kotlin
class C {
    var prop: Type by MyDelegate()
}

val c = C()

class C {
    private val <delegate> = MyDelegate()
    var prop: Type
    get() = <delegate>.getValue(this, <property>)
    set(value: Type) = <delegate>.setValue(this, <property>, value)
}
```

- ì»´íŒŒì¼ëŸ¬ëŠ” MyDelegate í´ë˜ìŠ¤ì˜ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ê°ì¶°ì§„ í”„ë¡œí¼í‹°ì— ì €ì¥í•˜ë©° ê·¸ ê°ì¶°ì§„ í”„ë¡œí¼í‹°ë¥¼ <delegate>ë¼ëŠ” ì´ë¦„ìœ¼ë¡œ ë¶€ë¥¸ë‹¤. ë˜í•œ ì»´íŒŒì¼ëŸ¬ëŠ” í”„ë¡œí¼í‹°ë¥¼ í‘œí˜„í•˜ê¸° ìœ„í•´ KProperty íƒ€ì…ì˜ ê°ì²´ë¥¼ ì‚¬ìš©í•œë‹¤. ì´ ê°ì²´ë¥¼ <property>ë¼ê³  ë¶€ë¥¸ë‹¤.

<aside>
ğŸ’¡ val x = c.prop â†’ val x = <delegate>.getValue(c, <property>)
c.prop = x â†’ <delegate>.setValue(c, <property>, x)

</aside>

### í”„ë¡œí¼í‹° ê°’ì„ ì•±ì— ì €ì¥

```kotlin

class Person {
    private val _attributes = hashMapOf<String, String>()
    
    fun setAttribute(attrName: String, value: String) {
        _attribute[attrName] = value
    }

    val name: String
    get() = _attributes["name"]!!
}

// ìœ„ì„ í”„ë¡œí¼í‹° ì ìš©
class Person {
    private val _attributes = hashMapOf<String, String>()

    fun setAttribute(attrName: String, value: String) {
        _attributes[attrName] = value
    }

    val name: String by _attributes
}

val p = Person()
val data = mapOf("name" to "ppeper", "company" to "Naver")
for ((attrName, value) in data) {
    p.setAttribute(attrName, value)
}
println(p.name)
```

- í‘œì¤€ ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ Map ê³¼ MutableMap ì¸í„°í˜ì´ì„œì— ëŒ€í•´ getValue, setValue í™•ì¥ í•¨ìˆ˜ë¥¼ ì œê³µí•˜ì—¬ ë™ì‘ì´ ê°€ëŠ¥í•˜ë‹¤.

### í”„ë ˆì„ì›Œí¬ì—ì„œ ìœ„ì„ í”„ë¡œí¼í‹° í™œìš©

- ë°ì´í„°ë² ì´ìŠ¤ì— User ë¼ëŠ” í…Œì´ë¸”ì´ ìˆê³  ê·¸ í…Œì´ë¸”ì—ëŠ” name, age ì—´ì´ ìˆë‹¤ê³  í•˜ì.
- Usersì™€ Userë¼ëŠ” í´ë˜ìŠ¤ë¥¼ ì½”í‹€ë¦°ì—ì„œ ì •ì˜í•˜ê³  ë°ì´í„°ë² ì´ìŠ¤ì— ë“¤ì–´ìˆëŠ” ëª¨ë“  ì‚¬ìš©ì ì—”í‹°í‹°ë¥¼ User í´ë˜ìŠ¤ë¥¼ í†µí•´ ê°€ì ¸ì˜¤ê³  ì €ì¥í•  ìˆ˜ ìˆë‹¤.

```kotlin
// ë°ì´í„°ë² ì´ìŠ¤ í…Œì´ë¸” í‘œí˜„  
object Users : IdTable() {
    val name = varchar("name", length = 50).index()
    val age = integer("age")
}

class User(id: EntityID) : Entity(id) {
    var name = String by Users.name
    var age = Int by Users.age
}
```