# 09. μ λ„¤λ¦­μ¤

- **μ‹¤μ²΄ν™”ν• νƒ€μ… νλΌλ―Έν„°**λ¥Ό μ‚¬μ©ν•λ©΄ μΈλΌμΈ ν•¨μ νΈμ¶μ—μ„ νƒ€μ… μΈμλ΅ μ“°μΈ κµ¬μ²΄μ μΈ νƒ€μ…μ„ μ‹¤ν–‰ μ‹μ μ— μ• μ μλ‹¤.
- **μ„ μ–Έ μ§€μ  λ³€μ„±**μ„ μ‚¬μ©ν•λ©΄ κΈ°μ € νƒ€μ…μ€ κ°™μ§€λ§ νƒ€μ… μΈμκ°€ λ‹¤λ¥Έ λ‘ μ λ„¤λ¦­ νƒ€μ… Type<A>μ™€ Type<B>κ°€ μμ„ λ• νƒ€μ… μΈμ Aμ™€ Bμ μƒμ„/ν•μ„ νƒ€μ… κ΄€κ³„μ— λ”°λΌ λ‘ μ λ„¤λ¦­ νƒ€μ…μ μƒμ„/ν•μ„ νƒ€μ… κ΄€κ³„κ°€ μ–΄λ–»κ² λλ”μ§€ μ§€μ •ν•  μ μλ‹¤.
- **μ‚¬μ© μ§€μ  λ³€μ„±**μ€ κ°™μ€ λ©ν‘(μ λ„¤λ¦­ νƒ€μ… κ°’ μ‚¬μ΄μ μƒμ„/ν•μ„ νƒ€μ… κ΄€κ³„ μ§€μ •)λ¥Ό μ λ„¤λ¦­ νƒ€μ… κ°’μ„ μ‚¬μ©ν•λ” μ„μΉμ—μ„ νλΌλ―Έν„° νƒ€μ…μ— λ€ν• μ μ•½μ„ ν‘μ‹ν•λ” λ°©μ‹μΌλ΅ λ‹¬μ„±ν•λ‹¤.

## π“Β μ λ„¤λ¦­ νƒ€μ… νλΌλ―Έν„°

- μ λ„¤λ¦­μ¤λ¥Ό μ‚¬μ©ν•λ©΄ **νƒ€μ… νλΌλ―Έν„°**λ¥Ό λ°›λ” νƒ€μ…μ„ μ •μν•  μ μλ‹¤.
- νƒ€μ… μΈμλ¥Ό μ¶”λ΅ ν•  μ μλ‹¤

```kotlin
// μ „λ‹¬λ κ°’λ“¤μ΄ StringμΌλ΅ μ»΄νμΌλ¬λ” List<String>μΌλ΅ μ¶”λ΅ ν•λ‹¤.
val authors = listOf("Dmitry", "Svetlana")
// λΉ λ¦¬μ¤νΈλ¥Ό λ§λ“¤λ©΄ νƒ€μ…μ„ μ§€μ •ν•΄μ•Ό ν•λ‹¤.
val readers = mutableListOf<String>()
```

<aside>
π’΅ μλ°”μ™€ λ‹¬λ¦¬ μ½”ν‹€λ¦°μ—μ„λ” μ λ„¤λ¦­ νƒ€μ…μ νƒ€μ… μΈμλ¥Ό ν”„λ΅κ·Έλλ¨Έκ°€ λ…μ‹ν•κ±°λ‚ μ»΄νμΌλ¬κ°€ μ¶”λ΅ ν•  μ μμ–΄μ•Ό ν•λ‹¤. μ½”ν‹€λ¦°μ€ μ²μλ¶€ν„° μ λ„¤λ¦­μ„ λ„μ…ν–κΈ° λ•λ¬Έμ— λ΅(raw) νƒ€μ…μ„ μ§€μ›ν•μ§€ μ•κ³  μ λ„¤λ¦­ νƒ€μ…μ νƒ€μ… μΈμλ¥Ό ν•­μƒ μ •μν•΄μ•Ό ν•λ‹¤.

</aside>

### μ λ„¤λ¦­ ν•¨μμ™€ ν”„λ΅νΌν‹°

- μ–΄λ–¤ νΉμ • νƒ€μ…μ„ μ €μ¥ν•λ” λ¦¬μ¤νΈλΏ μ•„λ‹λΌ λ¨λ“  λ¦¬μ¤νΈ(μ λ„¤λ¦­ λ¦¬μ¤νΈ)λ¥Ό λ‹¤λ£° μ μλ” ν•¨μλ¥Ό ν•λ‹¤λ©΄ μ•„λμ™€ κ°™μ€ μ λ„¤λ¦­ν•¨μλ¥Ό μ •μν•  μ μλ‹¤.

<img src="https://github.com/Moon3Bro/Kotlin-In-Action/assets/63226023/df6b614f-c9f0-4bfa-af40-ba11758106f5">

```kotlin
public fun <T> List<T>.slice(indices: IntRange): List<T> {
    if (indices.isEmpty()) return listOf()
    return this.subList(indices.start, indices.endInclusive + 1).toList()
}

public fun <T> List<T>.slice(indices: Iterable<Int>): List<T> {
    val size = indices.collectionSizeOrDefault(10)
    if (size == 0) return emptyList()
    val list = ArrayList<T>(size)
    for (index in indices) {
        list.add(get(index))
    }
    return list
}

val letters = ('a'..'z').toList()
println(letters.slice<Char>(0..2))
println(letters.slice(0..2))
```

- λ‘ νΈμ¶μ κ²°κ³Ό νƒ€μ…μ€ λ¨λ‘ `List<Char>` λ‹¤. μ»΄νμΌλ¬λ” λ°ν™ νƒ€μ… List<T>μ Tλ¥Ό μμ‹ μ΄ μ¶”λ΅ ν• Charλ΅ μΉν™ν•λ‹¤.

```kotlin
val <T> List<T>.penultimate: T
    get() = this[size - 2]

println(listOf(1, 2, 3, 4).penultimate)
>>> 3
```

<aside>
π’΅ μΌλ° (ν™•μ¥μ΄ μ•„λ‹) ν”„λ΅νΌν‹°λ” νƒ€μ… νλΌλ―Έν„°λ¥Ό κ°€μ§ μ μ—†λ‹¤

</aside>

### μ λ„¤λ¦­ ν΄λμ¤ μ„ μ–Έ

- μ½”ν‹€λ¦°μ—μ„λ„ νƒ€μ… νλΌλ―Έν„°λ¥Ό λ„£μ€ κΊΎμ‡  κΈ°νΈ(<>)λ¥Ό ν΄λμ¤ μ΄λ¦„ λ’¤μ— λ¶™μ΄λ©΄ ν΄λμ¤λ‚ μΈν„°νμ΄μ¤λ¥Ό μ λ„¤λ¦­ν•κ² λ§λ“¤ μ μλ‹¤.

```kotlin
interface List<T> {
    operator fun get(index: Int): T // μΈν„°νμ΄μ¤ μ•μ—μ„ Tλ¥Ό μΌλ° νƒ€μ…μ²λΌ μ‚¬μ©
}

class StringList: List<String> {
    override fun get(index: Int): String = ...
}

class ArrayList<T>: List<T> {
    override fun get(index : Int): T = ...
}
```

### νƒ€μ… νλΌλ―Έν„° μ μ•½

- νƒ€μ… νλΌλ―Έν„° μ μ•½μ€ ν΄λμ¤λ‚ ν•¨μμ— μ‚¬μ©ν•  μ μλ” νƒ€μ… μΈμλ¥Ό μ ν•ν•λ” κΈ°λ¥μ΄λ‹¤.

```kotlin
fun <T : Number> oneHalf(value: T): Double {
    return value.toDouble() / 2.0
}
println(oneHalf(3))
>>> 1.5
```

- νƒ€μ… νλΌλ―Έν„°λ¥Ό μ μ•½ν•λ” ν•¨μ

```kotlin
fun <T: Comparable<T>> max(first: T, second: T): T {
    return if (first > second) first else second
}

println(max("kotlin", "java"))
>>> kotlin

// λΉ„κµ λ¶κ°€λ¥ν• κ°’ μ‚¬μ΄μ— νΈμ¶ν•λ©΄ μ»΄νμΌ μ¤λ¥
println(max("kotlin", 42))
```

- νƒ€μ… νλΌλ―Έν„°μ— μ—¬λ¬ μ μ•½μ„ κ°€ν•κΈ°

```kotlin
fun <T> ensureTrailingPeriod(seq: T)
    where T : CharSequence, T : Appendable { // νƒ€μ… νλΌλ―Έν„° μ μ•½ λ©λ΅
    if (!seq.endsWith('.')) { // CharSequence μΈν„°νμ΄μ¤μ ν™•μ¥ ν•¨μλ¥Ό νΈμ¶
        seq.append('.') // Appendable μΈν„°νμ΄μ¤μ λ©”μ„λ“λ¥Ό νΈμ¶
    }
}

val helloWorld = StringBuilder("Hello World")
ensureTrailingPeriod(helloWorld)
println(helloWorld)
>> Hello World.
```

### νƒ€μ… νλΌλ―Έν„°λ¥Ό λ„μ΄ λ  μ μ—†λ” νƒ€μ…μΌλ΅ ν•μ •

- μ λ„¤λ¦­ ν΄λμ¤λ‚ ν•¨μλ¥Ό μ •μν•κ³  κ·Έ νƒ€μ…μ„ μΈμ¤ν„΄μ¤ν™”ν•  λ• λ„μ΄ λ  μ μλ” νƒ€μ…μ„ ν¬ν•¨ν•λ” μ–΄λ–¤ νƒ€μ…μΌλ΅ νƒ€μ… μΈμλ¥Ό μ§€μ •ν•΄λ„ νƒ€μ… νλΌλ―Έν„°λ¥Ό μΉν™ν•  μ μλ‹¤.
- μ•„λ¬΄λ° μƒν•μ„ μ •ν•μ§€ μ•μ€ νƒ€μ… νλΌλ―Έν„°λ” `Any?` λ¥Ό μƒν•μΌλ΅ μ •ν• νλΌλ―Έν„°μ™€ κ°™λ‹¤.

```kotlin
class Processor<T> {
    fun process(value: T) {
        value?.hashCode() // "value"λ” λ„μ΄ λ  μ μλ‹¤.  λ”°λΌμ„ μ•μ „ν• νΈμ¶μ„ μ‚¬μ©ν•΄μ•Ό ν•λ‹¤.
    }
}

// λ„μ΄ λ  μ μλ” String? μƒν•νƒ€μ…
val nullableStringProcessor = Processor<String?>()
nullableStringProcessor.process(null)

// λ„ κ°€λ¥μ„±μ„ μ μ™Έν• μ•„λ¬΄λ° μ μ•½μ΄ ν•„μ” μ—†λ‹¤λ©΄ Any? -> Anyλ¥Ό μƒν•μΌλ΅ μ‚¬μ©
class Processor<T: Any> {
    fun process(value: T) {
        value.hashCode()
    }
}
```

## π“Β μ‹¤ν–‰ μ‹ μ λ„¤λ¦­μ¤μ λ™μ‘: μ†κ±°λ νƒ€μ… νλΌλ―Έν„°μ™€ μ‹¤μ²΄ν™”λ νƒ€μ… νλΌλ―Έν„°

- JVMμ μ λ„¤λ¦­μ¤λ” λ³΄ν†µ `νƒ€μ… μ†κ±°` λ¥Ό μ‚¬μ©ν•΄ κµ¬ν„λλ‹¤. μ΄λ” μ‹¤ν–‰ μ‹μ μ— μ λ„¤λ¦­ ν΄λμ¤μ μΈμ¤ν„΄μ¤μ— νƒ•λΉ„ μΈμ μ •λ³΄κ°€ λ“¤μ–΄μμ§€ μ•λ‹¤λ” μλ―Έμ΄λ‹¤.
- μ½”ν‹€λ¦°μ—μ„ `inline` μΌλ΅ μ„ μ–Έν•¨μΌλ΅μ¨ νƒ€μ… μΈμκ°€ μ§€μ›μ§€μ§€ μ•κ² ν•  μ μλ‹¤.(μ½”ν‹€λ¦°μ—μ„λ” μ΄λ¥Ό μ‹¤μ²΄ν™”λΌκ³  λ¶€λ¥Έλ‹¤)

### μ‹¤ν–‰ μ‹μ „μ μ λ„¤λ¦­: νƒ€μ… κ²€μ‚¬μ™€ μΊμ¤νΈ

- μλ°”μ™€ λ§μ°¬κ°€μ§€λ΅ μ½”ν‹€λ¦° μ λ„¤λ¦­ νƒ€μ… μΈμ μ •λ³΄λ” **λ°νƒ€μ„μ— μ§€μ›μ§„λ‹¤**.
- List<String>, List<Int>μ λ‘ λ¦¬μ¤νΈκ°€ μ‹¤ν–‰ μ‹μ μ—μ„λ” κ°μ²΄λ” Listλ΅λ§ λ³Ό μ μλ‹¤.

```kotlin
// is μ½”λ“λ” λ°νƒ€μ„ μ‹ μ‚¬μ©ν•  μ μ—†λ‹¤. type erase
if (value is List<String>) { ... }
```

- μ–΄λ–¤ κ°’μ΄ μ§‘ν•©, λ§µμ΄ μ•„λ‹λΌ λ¦¬μ¤νΈλΌλ” μ‚¬μ‹¤μ„ ν™•μΈν•κΈ° μ„ν•΄μ„λ” μ¤νƒ€ ν”„λ΅μ μ…μ„ μ‚¬μ©ν•λ©΄ λλ‹¤

```kotlin
if (value is List<*>) { ... }
```

- μ λ„¤λ¦­ νƒ€μ…μΌλ΅ νƒ€μ… μΊμ¤ν…ν•κΈ°

```kotlin
fun printSum(c: Collection<*>) {
    val intList = c as? List<Int> // Unchecked cast: Collection<*> to List<Int> κ²½κ³  λ°μƒ
            ?: throw IllegalArgumentException("List is expected")
    println(intList.sum())
}

printSum(listOf(1, 2, 3))
>>> 6
```

- μλ»λ νƒ€μ…μ μ›μ†κ°€ λ“¤μ–΄μλ” λ¦¬μ¤νΈλ¥Ό μ „λ‹¬ν•λ©΄ μ‹¤ν–‰ μ‹μ μ— ClassCastExceptionμ΄ λ°μƒν•λ‹¤.
- μ•λ ¤μ§„ νƒ€μ… μΈμλ¥Ό μ‚¬μ©ν•΄ νƒ€μ… κ²€μ‚¬ν•κΈ°

```kotlin
fun printSum(c: Collection<Int>) {
    if (c is List<Int>) {
        println(c.sum())
    }
}
```

### μ‹¤μ²΄ν™”ν• νƒ€μ… νλΌλ―Έν„°λ¥Ό μ‚¬μ©ν• ν•¨μ μ„ μ–Έ

- μ λ„¤λ¦­ ν•¨μκ°€ νΈμ¶λλ„ κ·Έ ν•¨μμ λ³Έλ¬Έμ—μ„λ” νΈμ¶ μ‹ μ“°μΈ νƒ€μ… μΈμλ¥Ό μ• μ μ—†λ‹¤.
- ν•μ§€λ§ μΈλΌμΈ ν•¨μμ νƒ€μ… νλΌλ―Έν„°λ” μ‹¤μ²΄ν™”λλ―€λ΅ μ‹¤ν–‰ μ‹μ μ— μΈλΌμΈ ν•¨μμ νƒ€μ… μΈμλ¥Ό μ• μ μλ‹¤.
- `reified` ν‚¤μ›λ“λ¥Ό λ¶™μ΄λ©΄ μ»΄νμΌλ¬λ” μ‹¤ν–‰ μ‹μ μ— μ λ„¤λ¦­ μΈμ¤ν„΄μ¤λ¥Ό ν™•μΈ ν•  μ μλ‹¤.

```kotlin
inline fun <reified T> isA(value: Any) = value is T

println(isA<String>("abc"))
println(isA<String>(123))
>>> true
>>> false

// ν‘μ¤€ λΌμ΄λΈλ¬λ¦¬ ν•¨μ filterIsInstanceμ‚¬μ©ν•κΈ°
val items = listOf("one", 2, "three")
println(items.filterIsInstance<String>())
>>> [one, three]

public inline fun <reified R, C : MutableCollection<in R>> Iterable<*>.filterIsInstanceTo(destination: C): C {
    for (element in this) if (element is R) destination.add(element)
    return destination
}
```

<aside>
π’΅ μΈλΌμΈ ν•¨μμ—μ„λ§ μ‹¤μ²΄ν™”ν• νƒ€μ… μΈμλ¥Ό μ“Έ μ μλ” μ΄μ 
μ»΄νμΌλ¬λ” μ‹¤μ²΄ν™”ν• νƒ€μ… μΈμλ¥Ό μ‚¬μ©ν•΄ μΈλΌμΈ ν•¨μλ¥Ό νΈμ¶ν•λ” κ° λ¶€λ¶„μ μ •ν™•ν• νƒ€μ… μΈμλ¥Ό μ• μ μλ‹¤. λ”°λΌμ„ μ»΄νμΌλ¬λ” νƒ€μ… μΈμλ΅ μ“°μΈ κµ¬μ²΄μ μΈ ν΄λμ¤λ¥Ό μ°Έμ΅°ν•λ” λ°”μ΄νΈμ½”λ“λ¥Ό μƒμ„±ν•΄ μ‚½μ…ν•  μ μλ‹¤.

</aside>

- μλ°” μ½”λ“μ—μ„λ” reified νƒ€μ… νλΌλ―Έν„°λ¥Ό μ‚¬μ©ν•λ” inline ν•¨μλ¥Ό νΈμ¶ν•  μ μ—†λ‹¤λ” μ μ„ κΈ°μ–µν•μ.

### μ‹¤μ²΄ν™”ν• νƒ€μ… νλΌλ―Έν„°λ΅ ν΄λμ¤ μ°Έμ΅° λ€μ‹ 

```kotlin
// val serviceImpl = ServiceLoader.load(Service::class.java)
val serviceImpl = loadService<Service>()

inline fun <reified T> loadService() return ServiceLoader.load(T::class.java)
```

### μ‹¤μ²΄ν™”ν• νƒ€μ… νλΌλ―Έν„°μ μ μ•½

- μ‹¤μ²΄ν™”ν• νƒ€μ… νλΌλ―Έν„°λ¥Ό μ‚¬μ©ν•  μ μλ” κ²½μ°
    - νƒ€μ… κ²€μ‚¬μ™€ μΊμ¤ν… (is, !is, as, as?)
    - 10μ¥μ—μ„ μ„¤λ…ν•  μ½”ν‹€λ¦° λ¦¬ν”λ ‰μ… API(::class)
    - μ½”ν‹€λ¦° νƒ€μ…μ— λ€μ‘ν•λ” java.lang.Classλ¥Ό μ–»κΈ°(::class.java)
    - λ‹¤λ¥Έ ν•¨μλ¥Ό νΈμ¶ν•  λ• νƒ€μ… μΈμλ΅ μ‚¬μ©
- λ‹¤μκ³Ό κ°™μ€ μΌμ€ ν•  μ μ—†λ‹¤.
    - νƒ€μ… νλΌλ―Έν„° ν΄λμ¤μ μΈμ¤ν„΄μ¤ μƒμ„±ν•κΈ°
    - νƒ€μ… νλΌλ―Έν„° ν΄λμ¤μ λ™λ° κ°μ²΄ λ©”μ†λ“ νΈμ¶ν•κΈ°
    - μ‹¤μ²΄ν™”ν• νƒ€μ… νλΌλ―Έν„°λ¥Ό μ”κµ¬ν•λ” ν•¨μλ¥Ό νΈμ¶ν•λ©΄μ„ μ‹¤μ²΄ν™”ν•μ§€ μ•μ€ νƒ€μ… νλΌλ―Έν„°λ΅ λ°›μ€ νƒ€μ…μ„ νƒ€μ… μΈμλ΅ λ„κΈ°κΈ°
    - ν΄λμ¤, ν”„λ΅νΌν‹°, μΈλΌμΈ ν•¨μκ°€ μ•„λ‹ ν•¨μμ νƒ€μ… νλΌλ―Έν„°λ¥Ό reifiedλ΅ μ§€μ •ν•κΈ°

## π“Β λ³€μ„±: μ λ„¤λ¦­κ³Ό ν•μ„ νƒ€μ…

- λ³€μ„±μ κ°λ…
    - List<String>, List<Any> μ™€ κ°™μ΄ κΈ°μ € νƒ€μ…μ΄ κ°™κ³  νƒ€μ… μΈμκ°€ λ‹¤λ¥Έ μ—¬λ¬ νƒ€μ…μ΄ μ„λ΅ μ–΄λ–¤ κ΄€κ³„κ°€ μλ”μ§€ μ„¤λ…ν•λ” κ°λ…

### λ³€μ„±μ΄ μλ” μ΄μ : μΈμλ¥Ό ν•¨μμ— λ„κΈ°κΈ°

- List<Any> νƒ€μ…μ νλΌλ―Έν„°λ¥Ό λ°›λ” ν•¨μμ— List<String>μ„ λ„κΈ°λ©΄?
    - Stringν΄λμ¤λ” Anyλ¥Ό ν™•μ¥ν•λ―€λ΅ Any νƒ€μ… κ°’μ„ νλΌλ―Έν„°λ΅ λ°›λ” ν•¨μμ— String κ°’μ„ λ„κ²¨λ„ μ λ€λ΅ μ•μ „ν•λ‹¤.
    - ν•μ§€λ§ List μΈν„°νμ΄μ¤μ νƒ€μ… μΈμλ΅ λ“¤μ–΄κ°€λ” κ²½μ° μ•μ „μ„±μ„ λ§ν•  μ μ—†λ‹¤.

```kotlin
fun printContents(list: List<Any>) {
    println(list.joinToString())
}

printContents(listOf("abc", "bac"))
>>> abc, bac
```

- λ¦¬μ¤νΈλ¥Ό λ³€κ²½ν•λ” λ‹¤λ¥Έ ν•¨μ

```kotlin
fun addAnswer(list: MutableList<Any>) {
    list.add(42)
}

val strings = mutableListOf("abc", "bac")
// μ»΄νμΌμ—μ„ μ¤λ¥
addAnswer(strings)
```

- μ΄λ¬ν• κ²½μ°μ™€ κ°™μ΄ λ¦¬μ¤νΈμ— μ›μ†λ¥Ό μ¶”κ°€ν•κ±°λ‚ λ³€κ²½ν•λ‹¤λ©΄ νƒ€μ… λ¶μΌμΉκ°€ μƒκΈΈ μ μμ–΄ List<Any> λ€μ‹ μ— List<String>μ„ λ„κΈΈ μ μ—†λ‹¤.

### ν΄λμ¤, νƒ€μ…, ν•μ„ νƒ€μ…

- μ–΄λ–¤ νƒ€μ… Aμ κ°’μ΄ ν•„μ”ν• λ¨λ“  μ¥μ†μ— μ–΄λ–¤ νƒ€μ… Bμ κ°’μ„ λ„£μ–΄λ„ μ•„λ¬΄ λ¬Έμ κ°€ μ—†λ‹¤λ©΄ νƒ€μ… Bλ” νƒ€μ… Aμ ν•μ„ νƒ€μ…μ΄λ‹¤.
- λ³€μ λ€μ…μ΄λ‚ ν•¨μ μΈμ μ „λ‹¬ μ‹ ν•μ„ νƒ€μ… κ²€μ‚¬λ¥Ό λ§¤λ² μν–‰ν•λ‹¤.

```kotlin
fun test(i: Int) {
    val n: Number = i // Intκ°€ Numberμ ν•μ„ νƒ€μ…μ΄λ―€λ΅ μ»΄νμΌ λ¨
    fun f(s: String) {}
    f(i) // Intκ°€ Stringμ ν•μ„νƒ€μ„μ΄ μ•„λ‹λ―€λ΅ μ»΄νμΌ λ¶κ°€
}
```

<img src="https://github.com/Moon3Bro/Kotlin-In-Action/assets/63226023/0a1521ae-1d9d-4ec3-851a-8d19457b3e4d">

- λ¬΄κ³µλ³€
    - μ λ„¤λ¦­ νƒ€μ…μ„ μΈμ¤ν„΄μ¤ν™”ν•  λ• νƒ€μ… μΈμλ΅ μ„λ΅ λ‹¤λ¥Έ νƒ€μ…μ΄ λ“¤μ–΄κ°€λ©΄ μΈμ¤ν„΄μ¤ νƒ€μ… μ‚¬μ΄μ ν•μ„ νƒ€μ… κ΄€κ³„κ°€ μ„±λ¦½ν•μ§€ μ•μΌλ©΄ κ·Έ μ λ„¤λ¦­ νƒ€μ…μ„ λ¬΄κ³µλ³€μ΄λΌκ³  λ§ν•λ‹¤.
- κ³µλ³€μ 
    - Aκ°€ Bμ ν•μ„ νƒ€μ…μ΄λ©΄ List<A>λ” List<B>μ ν•μ„ νƒ€μ…μ΄λ‹¤. κ·Έλ° ν΄λμ¤λ‚ μΈν„°νμ΄μ¤λ¥Ό κ³µλ³€μ μ΄λΌ λ§ν•λ‹¤.

### κ³µλ³€μ„±: ν•μ„ νƒ€μ… κ΄€κ³„λ¥Ό μ μ§€

- Producer<T>λ¥Ό μμ‹λ΅ Aκ°€ Bμ ν•μ„ νƒ€μ…μΌ λ• Producer<A>κ°€ Producer<B>μ ν•μ„ νƒ€μ…μ΄λ©΄ Producerλ” κ³µλ³€μ μ΄λ‹¤.
- μ½”ν‹€λ¦°μ—μ„λ” μ λ„¤λ¦­ ν΄λμ¤κ°€ νƒ€μ… νλΌλ―Έν„°μ— λ€ν•΄ κ³µλ³€μ μ„μ„ ν‘μ‹ν•λ ¤λ©΄ νƒ€μ… νλΌλ―Έν„° μ•μ— `out` μ„ λ„£μ–΄μ•Ό ν•λ‹¤.

```kotlin
interface Producer<out T> {
    fun produce(): T
}
```

- ν΄λμ¤μ νƒ€μ… νλΌλ―Έν„°λ¥Ό κ³µλ³€μ μΌλ΅ λ§λ“¤λ©΄ ν•¨μ μ •μμ— μ‚¬μ©ν• νλΌλ―Έν„° νƒ€μ…κ³Ό νƒ€μ… μΈμμ νƒ€μ…μ΄ μ •ν™•ν μΌμΉν•μ§€ μ•λ”λΌλ„ κ·Έ ν΄λμ¤μ μΈμ¤ν„΄μ¤λ¥Ό ν•¨μ μΈμλ‚ λ°ν™κ°’μΌλ΅ μ‚¬μ©ν•  μ μλ‹¤.

```kotlin
open class Animal {
    fun feed() {...}
}

// μ΄ νƒ€μ… νλΌλ―Έν„°λ¥Ό λ¬΄κ³µλ³€μ„±μΌλ΅ μ§€μ •ν•λ‹¤.
class Herd<T: Animal> {
    val size: Int get() = {...}
    operator fun get(i : Int): T {...}
}

fun feedAll(animals: Herd<Anymal>) {
    for (i in 0 until animals.size){
        animals[i].feed()
    }
}
```

- μ‚¬μ©μ μ½”λ“κ°€ κ³ μ–‘μ΄ λ¬΄λ¦¬λ¥Ό λ§λ“¤μ–΄μ„ κ΄€λ¦¬ν•λ‹¤κ³  ν•μ

```kotlin
class Cat: Animal() {
    fun cleanLitter() {...}
}

fun takeCareOfCats(cats: Herd<Cat>) {
    for (i in 0 until cats.size) {
        cats[i].cleanLitter()
//        feedAll(cats)
// νƒ€μ…μ΄ μΌμΉν•μ§€ μ•μµλ‹λ‹¤.
// ν•„μ” ν•­λ©:
// Herd<Animal>
// λ°κ²¬λ ν•­λ©:
// Herd<Cat>
    }
}
```

- μ΄λ¥Ό κ³µλ³€μ  μ»¬λ ‰μ… μ—­ν• μ„ ν•λ” ν΄λμ¤μ„ μ‚¬μ©

```kotlin
class Herd<out T: Animal> {}

fun takeCareOfCats(cats: Herd<Cat>) {
    for (i in 0 until cats.size) {
        cats[i].cleanLitter()
    }
    feedAll(cats) // μΊμ¤ν… ν•  ν•„μ” μ—†λ‹¤.
}
```

- κ³µλ³€μ„±: ν•μ„ νƒ€μ… κ΄€κ³„κ°€ μ μ§€λλ‹¤.
- μ‚¬μ© μ ν•: Tλ¥Ό μ•„μ›ƒ μ„μΉμ—μ„λ§ μ‚¬μ©ν•  μ μλ‹¤.

<img src="https://github.com/Moon3Bro/Kotlin-In-Action/assets/63226023/db5809db-9b2f-44bd-b7e8-79ee99f8f1ab">

### λ°κ³µλ³€μ„±: λ’¤μ§‘ν ν•μ„ νƒ€μ… κ΄€κ³„

- Comparator μΈν„°νμ΄μ¤μ compare λ©”μ†λ“λ” Tνƒ€μ…μ„ μ†λΉ„ν•κΈ°λ§ ν•λ‹¤. μ΄λ” Tκ°€ `μΈ` μ„μΉμ—μ„λ§ μ“°μΈλ‹¤λ” λ»μ΄λ‹¤. λ”°λΌμ„ T μ•μ—λ” `in` ν‚¤μ›λ“λ¥Ό λ¶™μ—¬μ•Όλ§ ν•λ‹¤.
- νƒ€μ… Bκ°€ νƒ€μ… Aμ ν•μ„ νƒ€μ…μΈ κ²½μ° Consumer<A>κ°€ Consumer<B>μ ν•μ„ νƒ€μ…μΈ κ΄€κ³„κ°€ μ„±λ¦½ν•λ©΄ μ λ„¤λ¦­ ν΄λμ¤ Consumer<T>λ” νƒ€μ… μΈμ Tμ— λ€ν•΄ λ°κ³µλ³€μ΄λ‹¤.

<img src="https://github.com/Moon3Bro/Kotlin-In-Action/assets/63226023/e8740922-51ae-4d87-9fca-e6398723378e">

- Producer ν΄λμ¤λ” νƒ€μ… μΈμμ ν•μ„ νƒ€μ… κ΄€κ³„λ¥Ό κ·Έλ€λ΅ λ”°λ¥΄μ§€λ§ Comsumer ν΄λμ¤μ—μ„λ” νƒ€μ… μΈμμ ν•μ„ νƒ€μ… κ΄€κ³„μ™€λ” λ°λ€μ΄λ‹¤.

<img src="https://github.com/Moon3Bro/Kotlin-In-Action/assets/63226023/bff75ac8-5cb4-419d-a2bb-fd823e19b87b">

### μ‚¬μ© μ§€μ  λ³€μ„±: νƒ€μ…μ΄ μ–ΈκΈ‰λλ” μ§€μ μ—μ„ λ³€μ„± μ§€μ •

- μ„ μ–Έ μ§€μ  λ³€μ„±
    - ν΄λμ¤λ¥Ό μ„ μ–Έν•λ©΄μ„ λ³€μ„±μ„ μ§€μ •ν•λ©΄ κ·Έ ν΄λμ¤λ¥Ό μ‚¬μ©ν•λ” λ¨λ“  μ¥μ†μ— λ³€μ„± μ§€μ •μκ°€ μν–¥μ„ λΌμΉλ―€λ΅ νΈλ¦¬ν•λ‹¤.
- μ‚¬μ© μ§€μ  λ³€μ„±
    - μλ°”μ—μ„λ” νƒ€μ… νλΌλ―Έν„°κ°€ μλ” νƒ€μ…μ„ μ‚¬μ©ν•  λ•λ§λ‹¤ ν•΄λ‹Ή νƒ€μ… νλΌλ―Έν„°λ¥Ό ν•μ„ νƒ€μ…μ΄λ‚ μƒμ„ νƒ€μ… μ¤‘ μ–΄λ–¤ νƒ€μ…μΌλ΅ λ€μΉν•  μ μλ”μ§€ λ…μ‹ν•΄μ•Ό ν•λ‹¤.
- νƒ€μ„ νλΌλ―Έν„°κ°€ λ‘μΈ λ°μ΄ν„° λ³µμ‚¬ ν•¨μ

```kotlin
// source μ›μ† νƒ€μ…μ€ destination μ›μ† νƒ€μ…μ ν•μ„ νƒ€μ…μ΄μ–΄μ•Ό ν•λ‹¤.
fun <T: R, R> copyData(source: MutableList<T>, destination: MutableList<R>) {
    for (item in source) {
        destination.add(item)
    }
}

val ints = mutableListOf(1, 2, 3)
val anyItems = mutableListOf<Any>()
copyData(ints, anyItems) // Intκ°€ Anyμ ν•μ„ νƒ€μ…μ΄λ―€λ΅ μ΄ ν•¨μλ¥Ό νΈμ¶ν•  μ μλ‹¤.
println(anyItems)
```

- μ•„μ›ƒ-ν”„λ΅μ μ… νƒ€μ… νλΌλ―Έν„°λ¥Ό μ‚¬μ©ν•λ” λ°μ΄ν„° λ³µμ‚¬ ν•¨μ

```kotlin
fun <T> copyData(source: MutableList<out T>, destination: MutableList<T>) {
    for (item in source) {
        destination.add(item)
    }
}
```

- in ν”„λ΅μ μ Ό νƒ€μ… νλΌλ―Έν„°λ¥Ό μ‚¬μ©ν•λ” λ°μ΄ν„° λ³µμ‚¬ ν•¨μ

```kotlin
// μ›λ³Έ λ¦¬μ¤νΈ μ›μ† νƒ€μ…μ μƒμ„ νƒ€μ…μ„ λ€μƒ λ¦¬μ¤νΈ μ›μ† νƒ€μ…μΌλ΅ ν—μ©ν•λ‹¤.
fun <T> copyData(source: MutableList<T>, destination: MutableList<in T>) {
    for (item in source) {
        destination.add(item)
    }
}
```

<aside>
π’΅ μ½”ν‹€λ¦°μ μ‚¬μ© μ§€μ  λ³€μ„± μ„ μ–Έμ€ μλ°”μ `ν•μ • μ™€μΌλ“ μΉ΄λ“(bounded wildcard)μ™€ λ‘κ°™λ‹¤. μ½”ν‹€λ¦° MutableListλ” μλ°” MutableListμ™€ κ°™κ³  MutableListλ” μλ°” MutableListμ™€ κ°™λ‹¤.

</aside>

### μ¤νƒ€ ν”„λ΅μ μ…: νƒ€μ… μΈμ λ€μ‹  * μ‚¬μ©

- μ λ„¤λ¦­ νƒ€μ… μΈμ μ •λ³΄κ°€ μ—†μμ„ ν‘ν„ν•κΈ° μ„ν•΄ μ¤νƒ€ ν”„λ΅μ μ…μ„ μ‚¬μ©ν•λ‹¤κ³  ν•μ€λ‹¤.
- MutableList<*>λ” MutableList<Any?>μ™€ λΉ„μ·ν•μ§€λ§ κ°™μ§€ μ•λ‹¤. MutableList<Any?>λ” λ¨λ“  νƒ€μ…μ μ›μ†λ¥Ό λ‹΄μ„ μ μλ‹¤λ” μ‚¬μ‹¤μ„ μ• μ μλ” λ¦¬μ¤νΈλ‹¤.
- MutableList<*>λ” μ–΄λ–¤ μ •ν•΄μ§„ κµ¬μ²΄μ μΈ νƒ€μ…μ μ›μ†λ¥Ό μ €μ¥ν•κΈ° μ„ν•΄ λ§λ“¤μ–΄μ§„ κ²ƒμ΄λΌλ” λ»μ΄λ‹¤.
    - μ½”ν‹€λ¦°μ MyType<*>λ” μλ°”μ MyType<?>μ— λ€μ‘ν•λ‹¤.